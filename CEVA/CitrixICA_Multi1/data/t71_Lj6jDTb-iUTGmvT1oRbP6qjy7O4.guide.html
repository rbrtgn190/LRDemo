pendo.guideContent('rYjnSAsjlrJj7HNQkMXp-toWDRw@8FQpm_vBJ97Ik5YZuqSx1v2Xeik','6nIjNDAjySlbd8JMrNZ7HPT9jC0',"<div class=\"_pendo-launcher-section-content_ searchArticles\" data-id=\"gcSearchArticles\">\n    <div class=\"_pendo-launcher-section-body_\">\n        <div class=\"_pendo-suggested-articles_\">\n            <div class=\"_pendo-suggested-articles-list_\">\n                <ul>\n                    <li><a href=\"https://help-docs.citrix.com/\" target=\"_blank\"  class=\"suggested-article\" data-id=\"ws-add-instance\">Visit the Citrix Help Center</a></li>\n                    <li><a href=\"https://www.citrix.com/products/citrix-workspace/resources/user-adoption/how-to-download-citrix-workspace-app.html\" target=\"_blank\"  class=\"suggested-article\" data-id=\"ws-add-instance\">Install the Workspace App for easy access</a></li>\n                    <li><a href=\"https://help-docs.citrix.com/en-us/citrix-workspace-for-windows/display-view-desktops-in-desktop-viewer.html\" target=\"_blank\" class=\"suggested-article\" data-id=\"ws-get-started\">Desktop viewer for Workspace App</a></li>\n                    <li><a href=\"https://help-docs.citrix.com/en-us/citrix-workspace-for-android/access-apps-desktops.html\" target=\"_blank\"  class=\"suggested-article\" data-id=\"ws-add-instance\">Access apps and desktops on Android</a></li>\n                    <li><a href=\"https://help-docs.citrix.com/en-us/citrix-workspace-app-for-ios/accounts.html \" target=\"_blank\"  class=\"suggested-article\" data-id=\"ws-app-management\">Set up your account on iOS</a></li>\n                    <li><a href=\"https://help-docs.citrix.com/en-us/electronic-signature\" target=\"_blank\"  class=\"suggested-article\" data-id=\"ws-app-management\">Use electronic signature</a></li>\n               </ul>\n            </div>\n        </div>\n    </div>\n</div><style id=\"pendo-inline-css\" type=\"text/css\">#pendo-g-6nIjNDAjySlbd8JMrNZ7HPT9jC0 ._pendo-launcher-section-content_.searchArticles ._pendo-launcher-search-field_ {\n  height: 38px;\n  margin: 24px 18px;\n  position: relative;\n}\n#pendo-g-6nIjNDAjySlbd8JMrNZ7HPT9jC0 ._pendo-launcher-section-content_.searchArticles ._pendo-launcher-search-field_ ._pendo-search-input_ {\n  background-color: #fff;\n  border: 1px solid #969798;\n  border-radius: 2px;\n  color: #000;\n  font-size: 14px;\n  height: auto;\n  left: 0;\n  line-height: normal;\n  padding: 9px 16px;\n  position: absolute;\n  width: 76%;\n}\n#pendo-g-6nIjNDAjySlbd8JMrNZ7HPT9jC0 ._pendo-launcher-section-content_.searchArticles ._pendo-launcher-search-field_ ._pendo-search-input_:focus {\n  border-color: #0090dd;\n  box-shadow: 0 1px 2px 0 rgba(8, 44, 64, 0.3);\n  cursor: pointer;\n  outline: none;\n}\n#pendo-g-6nIjNDAjySlbd8JMrNZ7HPT9jC0 ._pendo-launcher-section-content_.searchArticles ._pendo-launcher-search-field_ ._pendo-search-clear-icon_ {\n  background: url('https://pendo-static-6508245000126464.storage.googleapis.com/EXFEln6MOEHSKfb5Q_Qa4XOQUdU/guide-media-859d993e-3f9b-4fd0-9e07-b6b7902c481c') no-repeat;\n  background-size: 15px 15px;\n  height: 15px;\n  position: absolute;\n  right: 75px;\n  top: 11px;\n  width: 15px;\n}\n#pendo-g-6nIjNDAjySlbd8JMrNZ7HPT9jC0 ._pendo-launcher-section-content_.searchArticles ._pendo-launcher-search-field_ ._pendo-search-clear-icon_:hover {\n  cursor: pointer;\n}\n#pendo-g-6nIjNDAjySlbd8JMrNZ7HPT9jC0 ._pendo-launcher-section-content_.searchArticles ._pendo-launcher-search-field_ ._pendo-search-submit_ {\n  -webkit-appearance: none;\n  background-color: #0090dd;\n  border: none;\n  border-radius: 2px;\n  color: #fff;\n  cursor: pointer;\n  font-size: 14px;\n  opacity: 1;\n  padding: 11px 7px;\n  position: absolute;\n  right: 0;\n  width: 20%;\n}\n#pendo-g-6nIjNDAjySlbd8JMrNZ7HPT9jC0 ._pendo-launcher-section-content_.searchArticles ._pendo-launcher-search-field_ ._pendo-search-submit_:disabled {\n  opacity: 0.4;\n  cursor: not-allowed;\n}\n#pendo-g-6nIjNDAjySlbd8JMrNZ7HPT9jC0 ._pendo-launcher-section-content_.searchArticles ._pendo-suggested-articles_ {\n  margin: 0 18px;\n}\n#pendo-g-6nIjNDAjySlbd8JMrNZ7HPT9jC0 ._pendo-launcher-section-content_.searchArticles ._pendo-suggested-articles_ ._pendo-suggested-articles-title_ {\n  color: #485264;\n  font-family: \"CitrixSans-SemiBold\", \"citrixsans\", sans-serif;\n  font-size: 16px;\n  line-height: normal;\n}\n#pendo-g-6nIjNDAjySlbd8JMrNZ7HPT9jC0 ._pendo-launcher-section-content_.searchArticles ._pendo-suggested-articles_ ._pendo-suggested-articles-list_ ul {\n  list-style: none;\n  padding-left: 0;\n}\n#pendo-g-6nIjNDAjySlbd8JMrNZ7HPT9jC0 ._pendo-launcher-section-content_.searchArticles ._pendo-suggested-articles_ ._pendo-suggested-articles-list_ ul li {\n  border-bottom: 1px solid #e7e9e9;\n  padding: 16px 0;\n}\n#pendo-g-6nIjNDAjySlbd8JMrNZ7HPT9jC0 ._pendo-launcher-section-content_.searchArticles ._pendo-suggested-articles_ ._pendo-suggested-articles-list_ ul li a {\n  color: #485264;\n  text-decoration: none;\n  font-size: 16px;\n  line-height: 1.25em;\n}\n#pendo-g-6nIjNDAjySlbd8JMrNZ7HPT9jC0 ._pendo-launcher-section-content_.searchArticles ._pendo-search-articles-results-list_ {\n  margin: 0 18px;\n}\n#pendo-g-6nIjNDAjySlbd8JMrNZ7HPT9jC0 ._pendo-launcher-section-content_.searchArticles ._pendo-search-articles-results-list_ ._pendo-doc-kb-result-total_ {\n  border-bottom: 1px solid #e7e9e9;\n  color: #485264;\n  display: block;\n  font-family: \"CitrixSans-SemiBold\", \"citrixsans\", sans-serif;\n  font-size: 16px;\n  line-height: normal;\n  padding-bottom: 14px;\n}\n#pendo-g-6nIjNDAjySlbd8JMrNZ7HPT9jC0 ._pendo-launcher-section-content_.searchArticles ._pendo-search-articles-results-list_ ._pendo-doc-kb-container_ ul {\n  list-style: none;\n  padding-left: 0;\n}\n#pendo-g-6nIjNDAjySlbd8JMrNZ7HPT9jC0 ._pendo-launcher-section-content_.searchArticles ._pendo-search-articles-results-list_ ._pendo-doc-kb-container_ ul li {\n  border-bottom: 1px solid #e7e9e9;\n  padding: 16px 0;\n}\n#pendo-g-6nIjNDAjySlbd8JMrNZ7HPT9jC0 ._pendo-launcher-section-content_.searchArticles ._pendo-search-articles-results-list_ ._pendo-doc-kb-container_ ul li a {\n  color: #485264;\n  text-decoration: none;\n  font-size: 16px;\n  line-height: 1.25em;\n}\n#pendo-g-6nIjNDAjySlbd8JMrNZ7HPT9jC0 ._pendo-launcher-section-content_.searchArticles ._pendo-search-articles-searching_ {\n  border-bottom: 1px solid #e7e9e9;\n  color: #485164;\n  font-size: 16px;\n  font-style: italic;\n  margin: 0 18px;\n  padding: 0 0 16px;\n}\n#pendo-g-6nIjNDAjySlbd8JMrNZ7HPT9jC0 ._pendo-launcher-section-content_.searchArticles ._pendo-search-articles-searching_ .spinner-container {\n  font-size: 24px;\n}\n#pendo-g-6nIjNDAjySlbd8JMrNZ7HPT9jC0 ._pendo-launcher-section-content_.searchArticles ._pendo-search-articles-results-list_ {\n  margin: 0 18px;\n  padding: 0 0 16px;\n}\n#pendo-g-6nIjNDAjySlbd8JMrNZ7HPT9jC0 ._pendo-launcher-section-content_.searchArticles ._pendo-search-articles-results-list_ .no-results .message {\n  border-bottom: 1px solid #e7e9e9;\n  color: #485164;\n  font-size: 16px;\n  font-style: italic;\n  padding-bottom: 16px;\n}\n#pendo-g-6nIjNDAjySlbd8JMrNZ7HPT9jC0 ._pendo-launcher-section-content_.searchArticles ._pendo-search-articles-results-list_ .no-results .other-resources {\n  font-size: 14px;\n  margin: 0 auto;\n  padding: 16px 0;\n  text-align: center;\n  width: 65%;\n}\n#pendo-g-6nIjNDAjySlbd8JMrNZ7HPT9jC0 ._pendo-launcher-section-content_.searchArticles ._pendo-search-articles-results-list_ .no-results .other-resources img {\n  margin-bottom: 8px;\n}\n#pendo-g-6nIjNDAjySlbd8JMrNZ7HPT9jC0 ._pendo-launcher-section-content_.searchArticles ._pendo-inactive {\n  display: none;\n}\n</style><script id=\"pendo-inline-script\">\n<% if (typeof guide !== 'undefined') { %>\nvar guide = pendo.findGuideById('<%= guide.id %>');\nvar step = guide && guide.findStepById('<%= step.id %>');\n<% } %>\n/*BEGIN PENDO SCRIPT WRAPPER*/\n/* Custom KB and Docs Integration by Pendo */\n\n(function(dom, ajax, _) {\n    var knowledgebaseUrl = 'https://support.citrix.com/';\n    var knowledgebaseSearchRoute = 'search/api/v1/search/gcs/support';\n    var docsUrl = 'https://docs.citrix.com/';\n    var docsSearchRoute = '.netlify/functions/';\n    // Set locale for docs which includes region\n    var docsLocale = '&locale='.concat(getCookie('language'));\n    //var suggestedArticleTemplate = 'eDZuleIg8ibooRkEd-OeW1Xsk4o';\n    var activeClass = '_pendo-active';\n    var inactiveClass = '_pendo-inactive';\n    var service = 'Workspace';\n    var products = {};\n\n    dom('.no-results')\n        .addClass(inactiveClass)\n        .attr('data-context', 'no-results');\n    dom('._pendo-suggested-articles_').attr('data-context', 'suggestions');\n    dom('._pendo-search-articles-searching_')\n        .addClass(inactiveClass)\n        .attr('data-context', 'searching');\n    //mapService();\n    mapServiceToProduct(service);\n    addServiceToContainer(service);\n\n    dom('._pendo-launcher-section-content_[data-id=\"gcSearchArticles\"]')\n        .on('keyup', 'input._pendo-search-input_', function(e) {\n            if (dom('input._pendo-search-input_')[0].value.length >= 0) {\n                switchSearchIcon('clear');\n                if (dom('input._pendo-search-input_')[0].value.length >= 3) {\n                    shouldEnableSubmitButton(true);\n                }\n            }\n            if (\n                (e.which === 8 || e.which === 13) &&\n                dom('input._pendo-search-input_')[0].value.length === 0\n            ) {\n                shouldEnableSubmitButton(false);\n                switchSearchIcon('search');\n                resetSearch(e);\n            }\n            if (\n                e.which === 13 &&\n                dom('input._pendo-search-input_')[0].value.length >= 3\n            ) {\n                delaySearch(e);\n                // display results and removal of loading occurs in above functions then/catch clause\n                e.preventDefault();\n            }\n        })\n        .on('keypress', 'input._pendo-search-input_', function(e) {\n            if (e.which === 13) {\n                e.preventDefault();\n            }\n        })\n        .on('click', '._pendo-search-submit_', function(e) {\n            // Add loading class & hide recommendations\n            delaySearch(e);\n            // display results and removal of loading occurs in above functions then/catch clause\n            e.preventDefault();\n        })\n        .on('click', '._pendo-search-clear-icon_', function clearSearch(e) {\n            resetSearch(e);\n        })\n        .on('click', '._pendo-doc-kb-container_ a', function(e) {\n            sendTrackEvent(\n                e,\n                'Resource Center - Search Articles - Result Clicked'\n            );\n        })\n        .on('click', '.suggested-article', function(e) {\n            sendTrackEvent(\n                e,\n                'Resource Center - Search Articles - Suggestion Clicked'\n            );\n        });\n\n    /* ########################################################################### */\n    var delaySearch = _.debounce(fetchFromSource, 500, false);\n\n    function addResultsToContainer(results, event) {\n        /**\n         * After results return from API build results and send track event\n         * @param {Array} results list of search results from the API\n         * @param {event} event Browser event to pluck properties from for track events\n         */\n        if (!docsLocale.includes('en-us')) {\n            if (!validateLocaliziedResults(results).docsOk) {\n                return showNoResults(event);\n            }\n        } else {\n            var checkedResults = validateResults(results);\n            if (!checkedResults.docsOk && !checkedResults.kbOk) {\n                return showNoResults(event);\n            }\n        }\n        dom('._pendo-search-articles-results-list_').append(\n            '<div class=\"_pendo-doc-kb-container_\"><ul class=\"_pendo-doc-kb-list_\"></ul></div>'\n        );\n        dom('._pendo-doc-kb-container_').prepend(buildResultCount(results));\n        dom('._pendo-doc-kb-list_').append(buildResultsHtml(results));\n        contentHasLoaded();\n        sendTrackEvent(event, 'Resource Center - Search Articles - Search');\n    }\n\n    function appendRegion(locale) {\n        /**\n         * Docs requires region based locations\n         * @param  {String} locale language local return from cookie data\n         * @return {String} A concatenated string with locale and region\n         */\n        switch (locale) {\n            case 'de':\n                return (region = locale.concat('-de'));\n            case 'en':\n                return (region = locale.concat('-us'));\n            case 'es':\n                return (region = locale.concat('-es'));\n            case 'fr':\n                return (region = locale.concat('-fr'));\n            case 'ja':\n                return (region = locale.concat('-jp'));\n        }\n    }\n\n    function addServiceToContainer(currentService) {\n        /**\n         * Provide context for feature tagging. Placed on the DOM element\n         * @param  {String} currentService service the visitor is currently using\n         */\n        if (dom('.searchArticles[data-id=\"gcSearchArticles\"]').length) {\n            dom('.searchArticles[data-id=\"gcSearchArticles\"]').attr(\n                'data-service',\n                currentService\n            );\n        }\n    }\n\n    function buildResultCount(results) {\n        /**\n         * Add the total number of results to the DOM\n         * @param  {Array} results list of search results from the API\n         * @return {String} HTML string with the count\n         */\n        var count = 0;\n        _.each(results, function(result) {\n            if (result.data.items) {\n                count += result.data.items.length;\n            }\n        });\n        return (\n            '<span class=\"_pendo-doc-kb-result-total_\">' +\n            count +\n            ' results found</span>'\n        );\n    }\n\n    function buildResultsHtml(results) {\n        /**\n         * Create the HTML for the aggregated kb and doc results\n         * @param  {String} results list of search results from the API\n         * @return {String} HTML string with the kb and doc content\n         */\n        var html = [];\n        _.each(results, function(result) {\n            if (result.data.context) {\n                html.push(createDocsHtml(result.data));\n            } else {\n                html.push(createKbHtml(result.data));\n            }\n        });\n        return html.join('\\n');\n    }\n\n    function buildSearchTerms() {\n        /**\n         * Compile the text values from the inputs for Docs and KB requests\n         * @return {Object} An object with kb and docs configs\n         */\n        var knowledgebaseSearchText = dom('input._pendo-search-input_')[0]\n            .value;\n        var docsSearchText = encodeURIComponent(knowledgebaseSearchText);\n        var docsSearchQuery = 'gsearch?q='.concat(docsSearchText);\n        var knowledgebaseRequest = buildRequest(\n            'knowledgebase',\n            knowledgebaseSearchText\n        );\n        var docsRequest = buildRequest('docs', docsSearchQuery);\n        return {\n            kb: knowledgebaseRequest,\n            docs: docsRequest\n        };\n    }\n\n    function buildRequest(type, search) {\n        /**\n         * Take the search terms and build a request\n         * @param  {String} type knowledgebase or docs\n         * @param  {String} search search terms\n         * @return {Object} A request config for ajax\n         */\n        if (docsLocale.includes('en-us') && type === 'knowledgebase') {\n            return {\n                url: knowledgebaseUrl.concat(knowledgebaseSearchRoute),\n                method: 'POST',\n                data: JSON.stringify({\n                    startIndex: 1,\n                    searchText: search,\n                    sortBy: 'relevance',\n                    filters: {\n                        products: products.kb,\n                        contentTypes: ''\n                    }\n                }),\n                headers: { 'Content-type': 'application/json; charset=UTF-8' }\n            };\n        }\n        if (!docsLocale.includes('en-us') && type === 'knowledgebase')\n            return {};\n        if (type === 'docs') {\n            var url = docsUrl\n                .concat(docsSearchRoute)\n                .concat(search)\n                .concat(docsLocale)\n                .concat(products.docs);\n            return {\n                method: 'GET',\n                url: url\n            };\n        }\n    }\n\n    function contentHasLoaded() {\n        /**\n         * Toggle active and inactive classes for display of search results\n         */\n        dom('._pendo-search-articles-searching_')\n            .addClass(inactiveClass)\n            .removeClass(activeClass);\n        dom('._pendo-doc-kb-container_')\n            .removeClass(inactiveClass)\n            .addClass(activeClass)\n            .attr('data-context', 'search-results');\n    }\n\n    function contentIsLoading() {\n        /**\n         * Reset container state and display loading animation\n         */\n        if (\n            dom('._pendo-doc-kb-container_').hasClass(activeClass) ||\n            dom('.no-results').hasClass(activeClass)\n        ) {\n            resetActiveElement(dom('.' + activeClass));\n        }\n        dom('._pendo-suggested-articles_')\n            .addClass(inactiveClass)\n            .removeClass(activeClass);\n        dom('._pendo-search-articles-searching_')\n            .removeClass(inactiveClass)\n            .addClass(activeClass);\n    }\n\n    function createDocsHtml(docData) {\n        /**\n         * Helper to create the HTML structure of the doc content\n         * @param  {Array} docData list of doc search results from the API\n         * @return {String} HTML string with the doc content\n         */\n        var docHtml = [];\n        _.each(docData.items, function(doc) {\n            docHtml.push(\n                '<li><a class=\"doc\" href=\"' +\n                    doc.link +\n                    '\" target=\"_blank\" data-doc-title=\"' +\n                    doc.title +\n                    '\">' +\n                    doc.title +\n                    '</a></li>'\n            );\n        });\n        return docHtml.join('\\n');\n    }\n\n    function createKbHtml(kbData) {\n        /**\n         * Helper to create the HTML structure of the kb content\n         * @param  {Array} kbData list of kb search results from the API\n         * @return {String} HTML string with the kb content\n         */\n        kbHtml = [];\n        _.each(kbData.items, function(kb) {\n            kbHtml.push(\n                '<li><a class=\"kb\" href=\"' +\n                    kb.link +\n                    '\" target=\"_blank\" data-kb-title=\"' +\n                    kb.title +\n                    '\">' +\n                    kb.title +\n                    '</a></li>'\n            );\n        });\n        if (!kbHtml.length) {\n            return '<li style=\"display: none\"></li>';\n        } else {\n            return kbHtml.join('\\n');\n        }\n    }\n\n    function fetchFromSource(event) {\n        /**\n         * Send request to endpoints specified in configs\n         * @return {Object} creates a object for the results\n         */\n        var event = event;\n        contentIsLoading();\n        var requestObject = buildSearchTerms();\n        Promise.all([\n            getSearchResults(requestObject.kb),\n            getSearchResults(requestObject.docs)\n        ])\n            .then(function logResp(res) {\n                // TODO: write results\n                addResultsToContainer(res, event);\n            })\n            .catch(function logErr(err) {\n                showNoResults(event);\n            });\n    }\n\n    function getArticleProps(articleType, event) {\n        /**\n         * For tracking the title of articles a users selects\n         * @param  {String} articleType types of articles available (kb, doc, suggestions)\n         * @param  {Object} event the browser event\n         * @return {String} the title of the article\n         */\n        switch (articleType) {\n            case 'kb':\n                return {\n                    title: event.target.dataset.kbTitle,\n                    href: event.target.href\n                };\n            case 'doc':\n                return {\n                    title: event.target.dataset.docTitle,\n                    href: event.target.href\n                };\n            case 'suggestion':\n                return { title: event.target.text, href: event.target.href };\n        }\n    }\n\n    function getArticleType(event) {\n        /**\n         * Determines the type of article the user clicks on for track events\n         * @param  {Object} event the browser event\n         * @return {String} a string representing the type of article\n         */\n        var classList = event.target.classList;\n\n        if (pendo._.contains(classList, 'kb')) {\n            return 'kb';\n        } else if (pendo._.contains(classList, 'doc')) {\n            return 'doc';\n        } else {\n            return 'suggestion';\n        }\n    }\n\n    function getCookie(name) {\n        /**\n         * Lookup a cookie value by name\n         * @param  {String} name key of the cookie to look up its value\n         * @return {String} return the region based locale\n         */\n        var match = document.cookie.match(\n            new RegExp('(^| )' + name + '=([^;]+)')\n        );\n        if (match) {\n            return appendRegion(match[2]);\n        }\n    }\n\n    function getSearchResults(config) {\n        /**\n         * Take the config and return search results\n         * @param  {Object} config request url, data, and headers\n         * @return {Promise}\n         */\n        if (_.isEmpty(config)) {\n            return {\n                data: 'No Search due to locale',\n                usingLocale: true\n            };\n        }\n        return ajax(config);\n    }\n\n    function mapService() {\n        /**\n         * Lookup the suggested articles guide to track user's current service\n         * @return {String} a string representing the service name\n         */\n        var suggestedArticlesGuide = _.filter(pendo.guides, function(guide) {\n            return guide.steps[0].templateId === suggestedArticleTemplate;\n        });\n\n        if (\n            suggestedArticlesGuide.length &&\n            suggestedArticlesGuide[0].steps[0].attributes.variables\n        ) {\n            if (\n                suggestedArticlesGuide[0].steps[0].attributes.variables\n                    .serviceName\n            ) {\n                service =\n                    suggestedArticlesGuide[0].steps[0].attributes.variables\n                        .serviceName;\n            }\n        }\n    }\n\n    function mapServiceToProduct(service) {\n        /**\n         * Map service from guide template to a consumable product for REST requests\n         * @param  {String} service which service visitor is currently using\n         * @return sets the values for the products object\n         */\n        var services = {\n            'Access Control': isAccessControl,\n            'Citrix Cloud': isCitrixCloud,\n            'Content Collaboration': isContentCollaboration,\n            'Endpoint Management': isEndpointManagement,\n            'Gateway': isGateway,\n            'Intelligent Traffic Management': isIntelligentTrafficManagement,\n            'Managed Desktops': isManagedDesktop,\n            'Microapps': isMicroapps,\n            'SD-WAN': isSDWAN,\n            'Secure Browser': isSecureBrowser,\n            'Secure Web Gateway': isSecureWebGateway,\n            'Smart Tools': isSmartTools,\n            'Virtual Apps and Desktops': isVirtualAppsAndDesktops,\n            'Web App Firewall': isWebAppFirewall,\n            'Workspace Environment Management': isWorkspaceEnvironmentManagement,\n            'Application Delivery Management': isApplicationDeliveryManagement,\n            'Workspace': isWorkspace,\n            default: isDefault\n        };\n\n        function isAccessControl() {\n            products['kb'] = '';\n            products['docs'] = '&products=citrix_access_control';\n        }\n        function isCitrixCloud() {\n            products['kb'] = 'Citrix Cloud';\n            products['docs'] = '&products=citrix_cloud_main';\n        }\n        function isContentCollaboration() {\n            products['kb'] = 'ShareFile';\n            products['docs'] = '&products=content_collaboration';\n        }\n        function isEndpointManagement() {\n            products['kb'] = 'XenMobile';\n            products['docs'] = '&products=endpoint_management';\n        }\n        function isGateway() {\n            products['kb'] = 'StoreFront, NetScaler Gateway';\n            products['docs'] = '&products=citrix_gateway_service';\n        }\n        function isIntelligentTrafficManagement() {\n            products['kb'] = '';\n            products['docs'] = '&products=intelligent_traffic_management';\n        }\n        function isManagedDesktop() {\n            products['kb'] = '';\n            products['docs'] = '&products=citrix_managed_desktops';\n        }\n        function isMicroapps() {\n            products['kb'] = '';\n            products['docs'] = '&products=';\n        }\n        function isSDWAN() {\n            products['kb'] = 'NetScaler SD-WAN (CloudBridge),Citrix SD-WAN';\n            products['docs'] = '&products=sd_wan_orchestrator';\n        }\n        function isSecureBrowser() {\n            products['kb'] = 'Citrix Secure Browser';\n            products['docs'] = '&products=citrix_cloud_main  ';\n        }\n        function isSecureWebGateway() {\n            products['kb'] = 'NetScaler Secure Web Gateway';\n            products['docs'] = '&products=citrix_secure_web_gateway';\n        }\n        function isSmartTools() {\n            products['kb'] = 'Citrix Cloud';\n            products['docs'] = '&products=';\n        }\n        function isVirtualAppsAndDesktops() {\n            // products['kb'] =\n            // 'XenDesktop,Citrix Virtual Apps and Desktops,XenApp';\n            products['kb'] = 'XenApp Essentials';\n            products['docs'] = '&products=virtual_apps_desktops ';\n        }\n        function isWebAppFirewall() {\n            products['kb'] = 'Application Firewall,NetScaler Gateway';\n            products['docs'] = '&products=citrix_web_app_firewall_service';\n        }\n        function isWorkspaceEnvironmentManagement() {\n            products['kb'] = '';\n            products['docs'] = '&products=workspace_environment_management';\n        }\n        function isApplicationDeliveryManagement() {\n            products['kb'] = 'Citrix Application Delivery Management';\n            products['docs'] = '&products=application_delivery_management';\n        }\n        function isWorkspace() {\n            products['kb'] = '';\n            products['docs'] = '&products=citrix_workspace';\n        }\n        function isDefault() {\n            products['kb'] = '';\n            products['docs'] = '';\n        }\n        return services[service]();\n    }\n\n    function resetActiveElement(activeElement) {\n        /**\n         * Clear the current active elements for displaying requested content\n         * @param  {String} activeElement DOM element with active class\n         */\n        if (activeElement.length) {\n            var context = activeElement[0].dataset.context;\n            var contexts = {\n                'search-results': resetSearchResults,\n                suggestions: resetSuggestions,\n                'no-results': resetNoResults,\n                searching: resetSearching\n            };\n\n            function resetSearchResults(activeElement) {\n                dom(activeElement).remove();\n            }\n            function resetSuggestions(activeElement) {\n                dom(activeElement)\n                    .find('._pendo-suggested-articles_')\n                    .removeClass(activeClass);\n            }\n            function resetNoResults(activeElement) {\n                if (activeElement[0].dataset.context === context) {\n                    dom(activeElement)\n                        .addClass(inactiveClass)\n                        .removeClass(activeClass);\n                } else {\n                    dom(activeElement)\n                        .find('.no-results')\n                        .removeClass(activeClass)\n                        .addClass(inactiveClass);\n                }\n            }\n            function resetSearching(activeElement) {\n                dom(activeElement)\n                    .removeClass(activeClass)\n                    .addClass(inactiveClass);\n            }\n            if (!_.isUndefined(context)) {\n                contexts[context](activeElement);\n            }\n        }\n    }\n\n    function resetSearch() {\n        /**\n         * Clears the input and changes the icons\n         */\n        var activeElement = dom('._pendo-active');\n        dom('input._pendo-search-input_')[0].value = '';\n        resetActiveElement(activeElement);\n        dom(activeElement)\n            .addClass(inactiveClass)\n            .removeClass(activeClass);\n        dom('._pendo-suggested-articles_')\n            .removeClass(inactiveClass)\n            .addClass(activeClass);\n        switchSearchIcon('search');\n        shouldEnableSubmitButton(false);\n    }\n\n    function sendTrackEvent(event, eventType) {\n        /**\n         * For tracking the events from the Search Articles integration\n         * @param {Object} event the browser event\n         * @param {String} eventType the title of the event to be sent to Pendo\n         * @return {String} the title of the article\n         */\n        var articleType = getArticleType(event);\n        var eligibleEvents = {\n            'Resource Center - Search Articles - Search': buildInputSubmitEvent,\n            'Resource Center - Search Articles - Result Clicked': buildResultClickedEvent,\n            'Resource Center - Search Articles - Suggestion Clicked': buildSuggestionClickedEvent,\n            'Resource Center - Search Articles - No Results': buildNoResultsEvent\n        };\n\n        function buildInputSubmitEvent(event) {\n            return {\n                searchString: dom('._pendo-search-input_')[0].value,\n                service: service\n            };\n        }\n        function buildResultClickedEvent(event) {\n            return {\n                searchString: dom('._pendo-search-input_')[0].value,\n                service: service,\n                title: getArticleProps(articleType, event).title,\n                href: getArticleProps(articleType, event).href,\n                articleType: articleType\n            };\n        }\n        function buildSuggestionClickedEvent(event) {\n            return {\n                title: getArticleProps(articleType, event).title,\n                service: service,\n                href: getArticleProps(articleType, event).href\n            };\n        }\n        function buildNoResultsEvent(event) {\n            return {\n                searchString: dom('._pendo-search-input_')[0].value,\n                service: service\n            };\n        }\n\n        if (!_.isUndefined(eventType)) {\n            pendo.log(\n                'Creating track event for ' +\n                    eventType +\n                    ' with properties: '.concat(\n                        JSON.stringify(eligibleEvents[eventType](event))\n                    )\n            );\n            pendo.track(eventType, eligibleEvents[eventType](event));\n        }\n    }\n\n    function shouldEnableSubmitButton(bool) {\n        /**\n         * Sets the enabled/disabled state of the search submit button\n         * @param  {String} bool true/false Javascript boolean\n         */\n        if (bool) {\n            if (dom('input._pendo-search-submit_')[0]) {\n                dom('input._pendo-search-submit_')[0].removeAttribute(\n                    'disabled'\n                );\n            }\n        }\n        if (!bool) {\n            dom('input._pendo-search-submit_').attr('disabled', true);\n        }\n    }\n\n    function showNoResults(event) {\n        /**\n         * Sets no results (.no-results) element active and sends track event when nothing is returned from the APIs\n         * @param  {Object} event the browser event\n         */\n        var activeElement = dom('._pendo-active');\n        resetActiveElement(activeElement);\n        dom('.no-results').removeClass(inactiveClass);\n        dom('.no-results').addClass(activeClass);\n        sendTrackEvent(event, 'Resource Center - Search Articles - No Results');\n    }\n\n    function switchSearchIcon(icon) {\n        /**\n         * Sets the icon for the search input\n         * @param  {String} icon string to represent which icon should be shown\n         */\n        if (icon === 'clear') {\n            dom('._pendo-search-clear-icon_').css({\n                background:\n                    'url(https://pendo-static-6508245000126464.storage.googleapis.com/EXFEln6MOEHSKfb5Q_Qa4XOQUdU/guide-media-31953d68-68ce-4a7f-b0b3-a3c6290df391) no-repeat center/15px 15px'\n            });\n        } else {\n            dom('._pendo-search-clear-icon_').css({\n                background:\n                    'url(https://pendo-static-6508245000126464.storage.googleapis.com/EXFEln6MOEHSKfb5Q_Qa4XOQUdU/guide-media-859d993e-3f9b-4fd0-9e07-b6b7902c481c) no-repeat center/15px 15px'\n            });\n        }\n    }\n\n    function validateLocaliziedResults(results) {\n        /**\n         * Check whether we have doc results from the API\n         * @param  {Array} results list of doc results from the API\n         * @return {Object} boolean values on an object for validation when displaying content\n         */\n        var validResults = {\n            kbOk: true\n        };\n        var docItems = _.find(results, function(result) {\n            return result.data.items;\n        });\n        if (_.isUndefined(docItems)) {\n            validResults['docsOk'] = false;\n        } else {\n            validResults['docsOk'] = true;\n        }\n        return validResults;\n    }\n\n    function validateResults(results) {\n        /**\n         * Check whether we have results from the API\n         * @param  {Array} results list of doc results from the API\n         * @return {Object} boolean values on an object for validation when displaying content\n         */\n        var validResults = {};\n        function validateDocs(result) {\n            if (!result.data.items) {\n                validResults['docsOk'] = false;\n            } else {\n                validResults['docsOk'] = true;\n            }\n        }\n        function validateKb(result) {\n            if (_.isEmpty(result.data.items)) {\n                validResults['kbOk'] = false;\n            }\n            if (!_.isEmpty(result.data.items)) {\n                validResults['kbOk'] = true;\n            }\n        }\n        _.each(results, function(result) {\n            if (result.data.kind) {\n                validateDocs(result);\n            } else {\n                validateKb(result);\n            }\n        });\n        return validResults;\n    }\n})(pendo.dom, pendo.ajax, pendo._);\n\n/*END PENDO SCRIPT WRAPPER*/</script>",function(root) {
var __t, __p = '';
__p += '<div class="_pendo-launcher-section-content_ searchArticles" data-id="gcSearchArticles">\n    <div class="_pendo-launcher-section-body_">\n        <div class="_pendo-suggested-articles_">\n            <div class="_pendo-suggested-articles-list_">\n                <ul>\n                    <li><a href="https://help-docs.citrix.com/" target="_blank"  class="suggested-article" data-id="ws-add-instance">Visit the Citrix Help Center</a></li>\n                    <li><a href="https://www.citrix.com/products/citrix-workspace/resources/user-adoption/how-to-download-citrix-workspace-app.html" target="_blank"  class="suggested-article" data-id="ws-add-instance">Install the Workspace App for easy access</a></li>\n                    <li><a href="https://help-docs.citrix.com/en-us/citrix-workspace-for-windows/display-view-desktops-in-desktop-viewer.html" target="_blank" class="suggested-article" data-id="ws-get-started">Desktop viewer for Workspace App</a></li>\n                    <li><a href="https://help-docs.citrix.com/en-us/citrix-workspace-for-android/access-apps-desktops.html" target="_blank"  class="suggested-article" data-id="ws-add-instance">Access apps and desktops on Android</a></li>\n                    <li><a href="https://help-docs.citrix.com/en-us/citrix-workspace-app-for-ios/accounts.html " target="_blank"  class="suggested-article" data-id="ws-app-management">Set up your account on iOS</a></li>\n                    <li><a href="https://help-docs.citrix.com/en-us/electronic-signature" target="_blank"  class="suggested-article" data-id="ws-app-management">Use electronic signature</a></li>\n               </ul>\n            </div>\n        </div>\n    </div>\n</div>';
return __p
},function(step,guide){/* Custom KB and Docs Integration by Pendo */

(function(dom, ajax, _) {
    var knowledgebaseUrl = 'https://support.citrix.com/';
    var knowledgebaseSearchRoute = 'search/api/v1/search/gcs/support';
    var docsUrl = 'https://docs.citrix.com/';
    var docsSearchRoute = '.netlify/functions/';
    // Set locale for docs which includes region
    var docsLocale = '&locale='.concat(getCookie('language'));
    //var suggestedArticleTemplate = 'eDZuleIg8ibooRkEd-OeW1Xsk4o';
    var activeClass = '_pendo-active';
    var inactiveClass = '_pendo-inactive';
    var service = 'Workspace';
    var products = {};

    dom('.no-results')
        .addClass(inactiveClass)
        .attr('data-context', 'no-results');
    dom('._pendo-suggested-articles_').attr('data-context', 'suggestions');
    dom('._pendo-search-articles-searching_')
        .addClass(inactiveClass)
        .attr('data-context', 'searching');
    //mapService();
    mapServiceToProduct(service);
    addServiceToContainer(service);

    dom('._pendo-launcher-section-content_[data-id="gcSearchArticles"]')
        .on('keyup', 'input._pendo-search-input_', function(e) {
            if (dom('input._pendo-search-input_')[0].value.length >= 0) {
                switchSearchIcon('clear');
                if (dom('input._pendo-search-input_')[0].value.length >= 3) {
                    shouldEnableSubmitButton(true);
                }
            }
            if (
                (e.which === 8 || e.which === 13) &&
                dom('input._pendo-search-input_')[0].value.length === 0
            ) {
                shouldEnableSubmitButton(false);
                switchSearchIcon('search');
                resetSearch(e);
            }
            if (
                e.which === 13 &&
                dom('input._pendo-search-input_')[0].value.length >= 3
            ) {
                delaySearch(e);
                // display results and removal of loading occurs in above functions then/catch clause
                e.preventDefault();
            }
        })
        .on('keypress', 'input._pendo-search-input_', function(e) {
            if (e.which === 13) {
                e.preventDefault();
            }
        })
        .on('click', '._pendo-search-submit_', function(e) {
            // Add loading class & hide recommendations
            delaySearch(e);
            // display results and removal of loading occurs in above functions then/catch clause
            e.preventDefault();
        })
        .on('click', '._pendo-search-clear-icon_', function clearSearch(e) {
            resetSearch(e);
        })
        .on('click', '._pendo-doc-kb-container_ a', function(e) {
            sendTrackEvent(
                e,
                'Resource Center - Search Articles - Result Clicked'
            );
        })
        .on('click', '.suggested-article', function(e) {
            sendTrackEvent(
                e,
                'Resource Center - Search Articles - Suggestion Clicked'
            );
        });

    /* ########################################################################### */
    var delaySearch = _.debounce(fetchFromSource, 500, false);

    function addResultsToContainer(results, event) {
        /**
         * After results return from API build results and send track event
         * @param {Array} results list of search results from the API
         * @param {event} event Browser event to pluck properties from for track events
         */
        if (!docsLocale.includes('en-us')) {
            if (!validateLocaliziedResults(results).docsOk) {
                return showNoResults(event);
            }
        } else {
            var checkedResults = validateResults(results);
            if (!checkedResults.docsOk && !checkedResults.kbOk) {
                return showNoResults(event);
            }
        }
        dom('._pendo-search-articles-results-list_').append(
            '<div class="_pendo-doc-kb-container_"><ul class="_pendo-doc-kb-list_"></ul></div>'
        );
        dom('._pendo-doc-kb-container_').prepend(buildResultCount(results));
        dom('._pendo-doc-kb-list_').append(buildResultsHtml(results));
        contentHasLoaded();
        sendTrackEvent(event, 'Resource Center - Search Articles - Search');
    }

    function appendRegion(locale) {
        /**
         * Docs requires region based locations
         * @param  {String} locale language local return from cookie data
         * @return {String} A concatenated string with locale and region
         */
        switch (locale) {
            case 'de':
                return (region = locale.concat('-de'));
            case 'en':
                return (region = locale.concat('-us'));
            case 'es':
                return (region = locale.concat('-es'));
            case 'fr':
                return (region = locale.concat('-fr'));
            case 'ja':
                return (region = locale.concat('-jp'));
        }
    }

    function addServiceToContainer(currentService) {
        /**
         * Provide context for feature tagging. Placed on the DOM element
         * @param  {String} currentService service the visitor is currently using
         */
        if (dom('.searchArticles[data-id="gcSearchArticles"]').length) {
            dom('.searchArticles[data-id="gcSearchArticles"]').attr(
                'data-service',
                currentService
            );
        }
    }

    function buildResultCount(results) {
        /**
         * Add the total number of results to the DOM
         * @param  {Array} results list of search results from the API
         * @return {String} HTML string with the count
         */
        var count = 0;
        _.each(results, function(result) {
            if (result.data.items) {
                count += result.data.items.length;
            }
        });
        return (
            '<span class="_pendo-doc-kb-result-total_">' +
            count +
            ' results found</span>'
        );
    }

    function buildResultsHtml(results) {
        /**
         * Create the HTML for the aggregated kb and doc results
         * @param  {String} results list of search results from the API
         * @return {String} HTML string with the kb and doc content
         */
        var html = [];
        _.each(results, function(result) {
            if (result.data.context) {
                html.push(createDocsHtml(result.data));
            } else {
                html.push(createKbHtml(result.data));
            }
        });
        return html.join('\n');
    }

    function buildSearchTerms() {
        /**
         * Compile the text values from the inputs for Docs and KB requests
         * @return {Object} An object with kb and docs configs
         */
        var knowledgebaseSearchText = dom('input._pendo-search-input_')[0]
            .value;
        var docsSearchText = encodeURIComponent(knowledgebaseSearchText);
        var docsSearchQuery = 'gsearch?q='.concat(docsSearchText);
        var knowledgebaseRequest = buildRequest(
            'knowledgebase',
            knowledgebaseSearchText
        );
        var docsRequest = buildRequest('docs', docsSearchQuery);
        return {
            kb: knowledgebaseRequest,
            docs: docsRequest
        };
    }

    function buildRequest(type, search) {
        /**
         * Take the search terms and build a request
         * @param  {String} type knowledgebase or docs
         * @param  {String} search search terms
         * @return {Object} A request config for ajax
         */
        if (docsLocale.includes('en-us') && type === 'knowledgebase') {
            return {
                url: knowledgebaseUrl.concat(knowledgebaseSearchRoute),
                method: 'POST',
                data: JSON.stringify({
                    startIndex: 1,
                    searchText: search,
                    sortBy: 'relevance',
                    filters: {
                        products: products.kb,
                        contentTypes: ''
                    }
                }),
                headers: { 'Content-type': 'application/json; charset=UTF-8' }
            };
        }
        if (!docsLocale.includes('en-us') && type === 'knowledgebase')
            return {};
        if (type === 'docs') {
            var url = docsUrl
                .concat(docsSearchRoute)
                .concat(search)
                .concat(docsLocale)
                .concat(products.docs);
            return {
                method: 'GET',
                url: url
            };
        }
    }

    function contentHasLoaded() {
        /**
         * Toggle active and inactive classes for display of search results
         */
        dom('._pendo-search-articles-searching_')
            .addClass(inactiveClass)
            .removeClass(activeClass);
        dom('._pendo-doc-kb-container_')
            .removeClass(inactiveClass)
            .addClass(activeClass)
            .attr('data-context', 'search-results');
    }

    function contentIsLoading() {
        /**
         * Reset container state and display loading animation
         */
        if (
            dom('._pendo-doc-kb-container_').hasClass(activeClass) ||
            dom('.no-results').hasClass(activeClass)
        ) {
            resetActiveElement(dom('.' + activeClass));
        }
        dom('._pendo-suggested-articles_')
            .addClass(inactiveClass)
            .removeClass(activeClass);
        dom('._pendo-search-articles-searching_')
            .removeClass(inactiveClass)
            .addClass(activeClass);
    }

    function createDocsHtml(docData) {
        /**
         * Helper to create the HTML structure of the doc content
         * @param  {Array} docData list of doc search results from the API
         * @return {String} HTML string with the doc content
         */
        var docHtml = [];
        _.each(docData.items, function(doc) {
            docHtml.push(
                '<li><a class="doc" href="' +
                    doc.link +
                    '" target="_blank" data-doc-title="' +
                    doc.title +
                    '">' +
                    doc.title +
                    '</a></li>'
            );
        });
        return docHtml.join('\n');
    }

    function createKbHtml(kbData) {
        /**
         * Helper to create the HTML structure of the kb content
         * @param  {Array} kbData list of kb search results from the API
         * @return {String} HTML string with the kb content
         */
        kbHtml = [];
        _.each(kbData.items, function(kb) {
            kbHtml.push(
                '<li><a class="kb" href="' +
                    kb.link +
                    '" target="_blank" data-kb-title="' +
                    kb.title +
                    '">' +
                    kb.title +
                    '</a></li>'
            );
        });
        if (!kbHtml.length) {
            return '<li style="display: none"></li>';
        } else {
            return kbHtml.join('\n');
        }
    }

    function fetchFromSource(event) {
        /**
         * Send request to endpoints specified in configs
         * @return {Object} creates a object for the results
         */
        var event = event;
        contentIsLoading();
        var requestObject = buildSearchTerms();
        Promise.all([
            getSearchResults(requestObject.kb),
            getSearchResults(requestObject.docs)
        ])
            .then(function logResp(res) {
                // TODO: write results
                addResultsToContainer(res, event);
            })
            .catch(function logErr(err) {
                showNoResults(event);
            });
    }

    function getArticleProps(articleType, event) {
        /**
         * For tracking the title of articles a users selects
         * @param  {String} articleType types of articles available (kb, doc, suggestions)
         * @param  {Object} event the browser event
         * @return {String} the title of the article
         */
        switch (articleType) {
            case 'kb':
                return {
                    title: event.target.dataset.kbTitle,
                    href: event.target.href
                };
            case 'doc':
                return {
                    title: event.target.dataset.docTitle,
                    href: event.target.href
                };
            case 'suggestion':
                return { title: event.target.text, href: event.target.href };
        }
    }

    function getArticleType(event) {
        /**
         * Determines the type of article the user clicks on for track events
         * @param  {Object} event the browser event
         * @return {String} a string representing the type of article
         */
        var classList = event.target.classList;

        if (pendo._.contains(classList, 'kb')) {
            return 'kb';
        } else if (pendo._.contains(classList, 'doc')) {
            return 'doc';
        } else {
            return 'suggestion';
        }
    }

    function getCookie(name) {
        /**
         * Lookup a cookie value by name
         * @param  {String} name key of the cookie to look up its value
         * @return {String} return the region based locale
         */
        var match = document.cookie.match(
            new RegExp('(^| )' + name + '=([^;]+)')
        );
        if (match) {
            return appendRegion(match[2]);
        }
    }

    function getSearchResults(config) {
        /**
         * Take the config and return search results
         * @param  {Object} config request url, data, and headers
         * @return {Promise}
         */
        if (_.isEmpty(config)) {
            return {
                data: 'No Search due to locale',
                usingLocale: true
            };
        }
        return ajax(config);
    }

    function mapService() {
        /**
         * Lookup the suggested articles guide to track user's current service
         * @return {String} a string representing the service name
         */
        var suggestedArticlesGuide = _.filter(pendo.guides, function(guide) {
            return guide.steps[0].templateId === suggestedArticleTemplate;
        });

        if (
            suggestedArticlesGuide.length &&
            suggestedArticlesGuide[0].steps[0].attributes.variables
        ) {
            if (
                suggestedArticlesGuide[0].steps[0].attributes.variables
                    .serviceName
            ) {
                service =
                    suggestedArticlesGuide[0].steps[0].attributes.variables
                        .serviceName;
            }
        }
    }

    function mapServiceToProduct(service) {
        /**
         * Map service from guide template to a consumable product for REST requests
         * @param  {String} service which service visitor is currently using
         * @return sets the values for the products object
         */
        var services = {
            'Access Control': isAccessControl,
            'Citrix Cloud': isCitrixCloud,
            'Content Collaboration': isContentCollaboration,
            'Endpoint Management': isEndpointManagement,
            'Gateway': isGateway,
            'Intelligent Traffic Management': isIntelligentTrafficManagement,
            'Managed Desktops': isManagedDesktop,
            'Microapps': isMicroapps,
            'SD-WAN': isSDWAN,
            'Secure Browser': isSecureBrowser,
            'Secure Web Gateway': isSecureWebGateway,
            'Smart Tools': isSmartTools,
            'Virtual Apps and Desktops': isVirtualAppsAndDesktops,
            'Web App Firewall': isWebAppFirewall,
            'Workspace Environment Management': isWorkspaceEnvironmentManagement,
            'Application Delivery Management': isApplicationDeliveryManagement,
            'Workspace': isWorkspace,
            default: isDefault
        };

        function isAccessControl() {
            products['kb'] = '';
            products['docs'] = '&products=citrix_access_control';
        }
        function isCitrixCloud() {
            products['kb'] = 'Citrix Cloud';
            products['docs'] = '&products=citrix_cloud_main';
        }
        function isContentCollaboration() {
            products['kb'] = 'ShareFile';
            products['docs'] = '&products=content_collaboration';
        }
        function isEndpointManagement() {
            products['kb'] = 'XenMobile';
            products['docs'] = '&products=endpoint_management';
        }
        function isGateway() {
            products['kb'] = 'StoreFront, NetScaler Gateway';
            products['docs'] = '&products=citrix_gateway_service';
        }
        function isIntelligentTrafficManagement() {
            products['kb'] = '';
            products['docs'] = '&products=intelligent_traffic_management';
        }
        function isManagedDesktop() {
            products['kb'] = '';
            products['docs'] = '&products=citrix_managed_desktops';
        }
        function isMicroapps() {
            products['kb'] = '';
            products['docs'] = '&products=';
        }
        function isSDWAN() {
            products['kb'] = 'NetScaler SD-WAN (CloudBridge),Citrix SD-WAN';
            products['docs'] = '&products=sd_wan_orchestrator';
        }
        function isSecureBrowser() {
            products['kb'] = 'Citrix Secure Browser';
            products['docs'] = '&products=citrix_cloud_main  ';
        }
        function isSecureWebGateway() {
            products['kb'] = 'NetScaler Secure Web Gateway';
            products['docs'] = '&products=citrix_secure_web_gateway';
        }
        function isSmartTools() {
            products['kb'] = 'Citrix Cloud';
            products['docs'] = '&products=';
        }
        function isVirtualAppsAndDesktops() {
            // products['kb'] =
            // 'XenDesktop,Citrix Virtual Apps and Desktops,XenApp';
            products['kb'] = 'XenApp Essentials';
            products['docs'] = '&products=virtual_apps_desktops ';
        }
        function isWebAppFirewall() {
            products['kb'] = 'Application Firewall,NetScaler Gateway';
            products['docs'] = '&products=citrix_web_app_firewall_service';
        }
        function isWorkspaceEnvironmentManagement() {
            products['kb'] = '';
            products['docs'] = '&products=workspace_environment_management';
        }
        function isApplicationDeliveryManagement() {
            products['kb'] = 'Citrix Application Delivery Management';
            products['docs'] = '&products=application_delivery_management';
        }
        function isWorkspace() {
            products['kb'] = '';
            products['docs'] = '&products=citrix_workspace';
        }
        function isDefault() {
            products['kb'] = '';
            products['docs'] = '';
        }
        return services[service]();
    }

    function resetActiveElement(activeElement) {
        /**
         * Clear the current active elements for displaying requested content
         * @param  {String} activeElement DOM element with active class
         */
        if (activeElement.length) {
            var context = activeElement[0].dataset.context;
            var contexts = {
                'search-results': resetSearchResults,
                suggestions: resetSuggestions,
                'no-results': resetNoResults,
                searching: resetSearching
            };

            function resetSearchResults(activeElement) {
                dom(activeElement).remove();
            }
            function resetSuggestions(activeElement) {
                dom(activeElement)
                    .find('._pendo-suggested-articles_')
                    .removeClass(activeClass);
            }
            function resetNoResults(activeElement) {
                if (activeElement[0].dataset.context === context) {
                    dom(activeElement)
                        .addClass(inactiveClass)
                        .removeClass(activeClass);
                } else {
                    dom(activeElement)
                        .find('.no-results')
                        .removeClass(activeClass)
                        .addClass(inactiveClass);
                }
            }
            function resetSearching(activeElement) {
                dom(activeElement)
                    .removeClass(activeClass)
                    .addClass(inactiveClass);
            }
            if (!_.isUndefined(context)) {
                contexts[context](activeElement);
            }
        }
    }

    function resetSearch() {
        /**
         * Clears the input and changes the icons
         */
        var activeElement = dom('._pendo-active');
        dom('input._pendo-search-input_')[0].value = '';
        resetActiveElement(activeElement);
        dom(activeElement)
            .addClass(inactiveClass)
            .removeClass(activeClass);
        dom('._pendo-suggested-articles_')
            .removeClass(inactiveClass)
            .addClass(activeClass);
        switchSearchIcon('search');
        shouldEnableSubmitButton(false);
    }

    function sendTrackEvent(event, eventType) {
        /**
         * For tracking the events from the Search Articles integration
         * @param {Object} event the browser event
         * @param {String} eventType the title of the event to be sent to Pendo
         * @return {String} the title of the article
         */
        var articleType = getArticleType(event);
        var eligibleEvents = {
            'Resource Center - Search Articles - Search': buildInputSubmitEvent,
            'Resource Center - Search Articles - Result Clicked': buildResultClickedEvent,
            'Resource Center - Search Articles - Suggestion Clicked': buildSuggestionClickedEvent,
            'Resource Center - Search Articles - No Results': buildNoResultsEvent
        };

        function buildInputSubmitEvent(event) {
            return {
                searchString: dom('._pendo-search-input_')[0].value,
                service: service
            };
        }
        function buildResultClickedEvent(event) {
            return {
                searchString: dom('._pendo-search-input_')[0].value,
                service: service,
                title: getArticleProps(articleType, event).title,
                href: getArticleProps(articleType, event).href,
                articleType: articleType
            };
        }
        function buildSuggestionClickedEvent(event) {
            return {
                title: getArticleProps(articleType, event).title,
                service: service,
                href: getArticleProps(articleType, event).href
            };
        }
        function buildNoResultsEvent(event) {
            return {
                searchString: dom('._pendo-search-input_')[0].value,
                service: service
            };
        }

        if (!_.isUndefined(eventType)) {
            pendo.log(
                'Creating track event for ' +
                    eventType +
                    ' with properties: '.concat(
                        JSON.stringify(eligibleEvents[eventType](event))
                    )
            );
            pendo.track(eventType, eligibleEvents[eventType](event));
        }
    }

    function shouldEnableSubmitButton(bool) {
        /**
         * Sets the enabled/disabled state of the search submit button
         * @param  {String} bool true/false Javascript boolean
         */
        if (bool) {
            if (dom('input._pendo-search-submit_')[0]) {
                dom('input._pendo-search-submit_')[0].removeAttribute(
                    'disabled'
                );
            }
        }
        if (!bool) {
            dom('input._pendo-search-submit_').attr('disabled', true);
        }
    }

    function showNoResults(event) {
        /**
         * Sets no results (.no-results) element active and sends track event when nothing is returned from the APIs
         * @param  {Object} event the browser event
         */
        var activeElement = dom('._pendo-active');
        resetActiveElement(activeElement);
        dom('.no-results').removeClass(inactiveClass);
        dom('.no-results').addClass(activeClass);
        sendTrackEvent(event, 'Resource Center - Search Articles - No Results');
    }

    function switchSearchIcon(icon) {
        /**
         * Sets the icon for the search input
         * @param  {String} icon string to represent which icon should be shown
         */
        if (icon === 'clear') {
            dom('._pendo-search-clear-icon_').css({
                background:
                    'url(https://pendo-static-6508245000126464.storage.googleapis.com/EXFEln6MOEHSKfb5Q_Qa4XOQUdU/guide-media-31953d68-68ce-4a7f-b0b3-a3c6290df391) no-repeat center/15px 15px'
            });
        } else {
            dom('._pendo-search-clear-icon_').css({
                background:
                    'url(https://pendo-static-6508245000126464.storage.googleapis.com/EXFEln6MOEHSKfb5Q_Qa4XOQUdU/guide-media-859d993e-3f9b-4fd0-9e07-b6b7902c481c) no-repeat center/15px 15px'
            });
        }
    }

    function validateLocaliziedResults(results) {
        /**
         * Check whether we have doc results from the API
         * @param  {Array} results list of doc results from the API
         * @return {Object} boolean values on an object for validation when displaying content
         */
        var validResults = {
            kbOk: true
        };
        var docItems = _.find(results, function(result) {
            return result.data.items;
        });
        if (_.isUndefined(docItems)) {
            validResults['docsOk'] = false;
        } else {
            validResults['docsOk'] = true;
        }
        return validResults;
    }

    function validateResults(results) {
        /**
         * Check whether we have results from the API
         * @param  {Array} results list of doc results from the API
         * @return {Object} boolean values on an object for validation when displaying content
         */
        var validResults = {};
        function validateDocs(result) {
            if (!result.data.items) {
                validResults['docsOk'] = false;
            } else {
                validResults['docsOk'] = true;
            }
        }
        function validateKb(result) {
            if (_.isEmpty(result.data.items)) {
                validResults['kbOk'] = false;
            }
            if (!_.isEmpty(result.data.items)) {
                validResults['kbOk'] = true;
            }
        }
        _.each(results, function(result) {
            if (result.data.kind) {
                validateDocs(result);
            } else {
                validateKb(result);
            }
        });
        return validResults;
    }
})(pendo.dom, pendo.ajax, pendo._);
});